<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Homestays - KK Homestay</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
  <h1>Available Homestays</h1>
  <nav>
    <a href="index.html">Home</a> | 
    <a href="login.html">Login</a> | 
    <a href="signup.html">Signup</a>
  </nav>
</header>
<section id="homestaysContainer"></section>
<script>
async function loadHomestays(){
  const res=await fetch('http://127.0.0.1:8000/homestays');
  const homestays=await res.json();
  const container=document.getElementById('homestaysContainer');
  container.innerHTML='';
  homestays.forEach(h=>{
    const div=document.createElement('div');
    div.className='homestay-card';
    div.innerHTML=`
      <h3>${h.name}</h3>
      <p>${h.location}</p>
      <p>Price: RM${h.price}</p>
      <div>${h.images.map(img=>`<img src="${img}">`).join('')}</div>
      <p>${h.description}</p>
      <button onclick="book(${h.id})">Book Now</button>
    `;
    container.appendChild(div);
  });
}
function book(hid){
  const user_id = localStorage.getItem('user_id');
  if(!user_id){ alert('Please login first'); return; }
  const date = prompt("Enter booking date (YYYY-MM-DD)");
  if(!date) return;
  fetch('http://127.0.0.1:8000/book',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({homestay_id:hid,user_id,date})
  }).then(()=>alert('Booking confirmed!'));
}
loadHomestays();
</script>
</body>
</html>
