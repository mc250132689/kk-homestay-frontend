<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸ’³ Payment - KK Homestay</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>
</head>
<body>
<header>
  <h1>Complete Payment</h1>
  <nav><a href="homestays.html">Back to Homestays</a></nav>
</header>

<section>
  <p>Pay securely via PayPal to confirm your booking.</p>
  <div id="paypal-button-container"></div>
</section>

<script>
const params = new URLSearchParams(window.location.search);
const bookingId = params.get("booking_id");
const API_BASE = "https://kk-homestay-backend.onrender.com";

paypal.Buttons({
    createOrder: function(data, actions) {
        return actions.order.create({
            purchase_units: [{
                amount: { value: '50.00' } // Replace with dynamic price
            }]
        });
    },
    onApprove: function(data, actions) {
        return actions.order.capture().then(async function(details) {
            alert("Payment completed by " + details.payer.name.given_name);
            // Update booking payment status
            await fetch(`${API_BASE}/update-payment`, {
                method: "POST",
                headers: {"Content-Type":"application/json"},
                body: JSON.stringify({ booking_id: bookingId, payment_status: "Paid" })
            });
            window.location.href="homestays.html";
        });
    }
}).render('#paypal-button-container');
</script>
</body>
</html>
